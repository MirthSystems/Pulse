<div class="container">
  <div class="back-link">
    <a routerLink="/home" mat-button>
      <mat-icon>arrow_back</mat-icon> Back to Home
    </a>
  </div>

  <div class="profile-container">
    <mat-card>
      <mat-card-header>
        <div mat-card-avatar class="profile-avatar" *ngIf="profilePicture">
          <img [src]="profilePicture" alt="Profile picture">
        </div>
        <div mat-card-avatar class="profile-avatar" *ngIf="!profilePicture && !loading">
          <mat-icon>account_circle</mat-icon>
        </div>
        <mat-card-title *ngIf="!loading && profile">{{ profile.displayName }}</mat-card-title>
        <mat-card-subtitle *ngIf="!loading && profile">{{ profile.mail || profile.userPrincipalName }}</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div *ngIf="loading" class="loading-container">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Loading your profile information...</p>
        </div>

        <div *ngIf="!loading && profile" class="profile-details">
          <h3>User Information</h3>
          <mat-divider></mat-divider>

          <mat-list>
            <mat-list-item *ngIf="profile.givenName">
              <mat-icon matListItemIcon>person</mat-icon>
              <div matListItemTitle>First Name</div>
              <div matListItemLine>{{ profile.givenName }}</div>
            </mat-list-item>

            <mat-list-item *ngIf="profile.surname">
              <mat-icon matListItemIcon>person</mat-icon>
              <div matListItemTitle>Last Name</div>
              <div matListItemLine>{{ profile.surname }}</div>
            </mat-list-item>

            <mat-list-item *ngIf="profile.mail">
              <mat-icon matListItemIcon>email</mat-icon>
              <div matListItemTitle>Email</div>
              <div matListItemLine>{{ profile.mail }}</div>
            </mat-list-item>

            <mat-list-item *ngIf="profile.jobTitle">
              <mat-icon matListItemIcon>work</mat-icon>
              <div matListItemTitle>Job Title</div>
              <div matListItemLine>{{ profile.jobTitle }}</div>
            </mat-list-item>

            <mat-list-item *ngIf="profile.department">
              <mat-icon matListItemIcon>groups</mat-icon>
              <div matListItemTitle>Department</div>
              <div matListItemLine>{{ profile.department }}</div>
            </mat-list-item>

            <mat-list-item *ngIf="profile.officeLocation">
              <mat-icon matListItemIcon>location_on</mat-icon>
              <div matListItemTitle>Office Location</div>
              <div matListItemLine>{{ profile.officeLocation }}</div>
            </mat-list-item>

            <mat-list-item>
              <mat-icon matListItemIcon>fingerprint</mat-icon>
              <div matListItemTitle>User ID</div>
              <div matListItemLine>{{ profile.id }}</div>
            </mat-list-item>
          </mat-list>
        </div>

        <div *ngIf="error" class="error-container">
          <mat-icon color="warn">error_outline</mat-icon>
          <p>{{ error }}</p>
          <button mat-raised-button color="primary" (click)="getProfile()">Try Again</button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
